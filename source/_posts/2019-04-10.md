---
title: day89-回调未调用（Promise）
tags: 
- 前端
categories: 
- 技术
date:  2019-4-10
grammar_cjkRuby: true
---
### 前言
回调函数本身包含JavaScript错误，Promise本身永远不被决议。怎么办？

![](https://ws1.sinaimg.cn/large/b15ca614ly1g1xxm4ej1tj20dw099q3d.jpg)


<!--more-->
### *竞态*(高级抽象机制)
```javascript
// 用于超时一个Promise的工具
function timeoutPromise (delay) {
  return new Promise((resolve, reject) => {
    setTimeout(() => {
      reject('timeout!')
    }, delay)
  })
}
// 设置foo()超时
Promise.race([
  foo(),
  timeoutPromise(3000)
])
.then(
  function () {
  // foo(..)及时完成
  },
  function (err) {
    // 或者foo()被拒绝，只是没能按时完成
    // 查看err来了解是哪种情况
  }
)
```
