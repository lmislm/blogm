---
title: day109-ts实现mvvm-笔记（2）
tags: 
- 前端
categories: 
- 技术
date:  2019-5-1
grammar_cjkRuby: true
---
### 前言
数组的依赖收集？？？

![](https://ws1.sinaimg.cn/large/b15ca614gy1g2m6x7ao74j20e609g3yu.jpg)
<!--more-->
### 代码

```typescript
import Dep from "../../2019-04/30/vuejs/dep";

// 上文2019-04-30-vuejs
// 数组的依赖收集
function defineReactive(obj: any, key: string, val?: any) {
  // ...
  if (Dep.target) {
    dep.depend()
    if (childOb) {
      childOb.dep.depend()
      if (Array.isArray(value)) {
        dependArray(value)
      }
    }
  }
  // ...
}

function dependArray (value: any[]) {
  for (let e, i = 0, l = value.length; i < l; i++) {
    e = value[i]
    // 多维数组？？
    e && e.__ob__ && e.__ob__.dep.depend()
    if (Array.isArray(e)) {
      dependArray(e)
    }
  }
}
```

